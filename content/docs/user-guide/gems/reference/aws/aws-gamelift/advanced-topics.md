---
linkTitle: Advanced Topics
title: Advanced Topics for AWS GameLift Gem
description: "Learn about advanced topics for using the AWS GameLift Gem in O3DE"
toc: true
---

This topic covers advanced topics with the AWS GameLift Gem. 

## Use resource mapping files
A fleet is a set of EC2 virtual computing machines, called *instances*, that represents your hosting resources. A `Fleet Id` is a unique identifier for each fleet, which is generated by the Amazon Gamelift service. 

In most cases, your game will use more than one fleet. To avoid using a fixed fleet id in your script, you can use a resource mapping file, which allows you to look up fleet ids at runtime. Using a resource mapping file helps keep your code or script clean and consistent. For more information, read [Resource Mapping Files](/docs/user-guide/gems/reference/aws/aws-core/resource-mapping-files/) in the AWS Core section. 


### Example

This example shows you how to look up a fleet from the resource mapping file, and with the fleet, create a session that allows one maximum player. 

The following steps walk you through the scripting example below. 
1. Get the request object for creating a session by using the **Get request** node.
2. Look up the fleet with the id `MyGameLiftFleetId` by using the **GetResourceNameId** node. 
3. For the corresponding fleet, set the maximum number of players to be `1` by using the **FleetId** and **MaxPlayer** nodes. 
4. Create a session on the fleet using the **CreateSessionAsync** node. 

![A script that gets a fleet from a resource mapping file and creates a session with 1 maximum player.](/images/user-guide/gems/reference/aws/aws-gamelift/createsessionandresourcemapping.PNG)

### Example

If you have multiple fleets, you can store the fleet ids in an array. Then, you can iterate through each fleet and search for active sessions in the corresponding fleet. 

The following steps walk you through the scripting example below. 
1. Iterate through an array of fleet ids by using the **Get fleetId Keys** and **For Each** nodes. 
2. For each fleet id:
   1. Look up the fleet corresponding to the fleet id by using the **GetResourceNameId** node. 
   2. Get a request object for searching through sessions using the **Get request** node. 
   3. Search for an active and joinable session using the **SearchSessionsAsync** node.

![A script that iterates through an array of fleets and searches for an active session.](/images/user-guide/gems/reference/aws/aws-gamelift/searchsessionsandresourcemapping.PNG)


## Search and join session workflow

The most basic way to search for sessions is by browsing through the server, which shows all of the available games. Then, the player can filter the games based on the type they want to play, choose a game, and join a session. 

### Example

This example shows you how to search for a maximum of ten sessions in the corresponding fleet. 

The following steps walk you through the scripting example below. 
1. Get a request object for searching sessions by using the **Get searchrequest** node. 
2. Look up the fleet with the id `MyGameLiftFleetId` by using the **GetResourceNameId** node. 
3. Filter the search with a maximum of ten sessions in the corresponding fleet using the **FleetId** and **MaxResult** nodes. 
4. Search for sessions by using **SearchSessionAsync** node. 
   
![A scipt that searches for a maximum of ten sessions in the corresponding fleet](/images/user-guide/gems/reference/aws/aws-gamelift/searchactivesessions.PNG)

### Example

After you get the results, choose the first game session and join. This workflow begins automatically when **SearchSessionAsync** completes with results. 

1. Set this workflow to begin automatically after searching for sessions by adding the **OnSearchSessionsAsyncComplete** event to **AWSGameLiftSessionAsyncRequestNotificationBus** and applying it to the **SessionConfigs** node. 
2. Get the first session from the results of the **SearchSessionAsync** node.
3. Get a request object to join the session by using the **SessionId** and **Get joinrequest** nodes. 
4. Create a player id for this session by using the **SessionId** and **CreatePlayerId** nodes. 
4. Allow a player to join this session by using the **PlayerId** and **JoinSessionAsync** nodes. 

![A script chooses a game from the results and joins the first session](/images/user-guide/gems/reference/aws/aws-gamelift/searchandjoin.PNG)


## Get credentials from Amazon Cognito identiy pool

To make requests against Amazon Gamelift service, you must grant players a valid permission to interact with your resources. With the [AWS Client Auth Gem](/docs/user-guide/gems/reference/aws/aws-client-auth/), you can get AWS credentials from Amazon Cognito Identiy Pool based on the player's login. 

The AWS GameLift Gem configures the client by using `AWSGameLiftClientManager::ConfigureGameLiftClient()`, and sets up th AWS credentials. To allow players to use Cognito Identiy Pool credential, the players must be successfully logged in using AWS Client Auth Gem. 


## Set up log path for multiple processes

GameLift fleets can be configured to run multiple processes on each instance, which can help customers use their hosting resources more efficiently, and potentially help reduce overall hosting costs. For more information, please read [Managing how game servers are launched for hosting](https://docs.aws.amazon.com/gamelift/latest/developerguide/fleets-multiprocess.html) in the Amazon GameLift documentation. 

To launch a server process on a GameLift fleet and save log files, use the following CLI command. You can make sure that each server process has its own log path by providing a unique identifier for each process in the `project-path` launch parameter. In this example, log files are saved to `C:\game\process1\user\log\` instead of the default log path.

```cmd
C:\game\bin\server.exe --engine-path=C:\game --project-path=C:\game\process1 --project-cache-path=C:\game\assets -bg_ConnectToAssetProcessor= 0
```


Previous Topic: [C++ API for AWS GameLift Gem](https://wiki.agscollab.com/pages/viewpage.action?pageId=126422034)

Next Topic: [AWS GameLift Gem Local Testing](https://wiki.agscollab.com/display/lmbr/AWS+GameLift+Gem+Local+Testing)