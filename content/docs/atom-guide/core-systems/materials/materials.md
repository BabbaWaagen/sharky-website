# Material System Overview

**Materials** contain data that control how model surfaces appear in a 3D environment. All materials have a **material type**, which classifies materials that share the same properties such as hard surfaces, cloth, or skin. Materials inherit properties either directly from the material type, or from other materials. 

Materials and material types are stored as data items in JSON files. The Atom Material Builder converts the data files into material assets. The material assets are then consumed by the application and applied to a mesh's surface. 

<!-- [NOTE FOR DEVS: Is this accurate? Is it Material Asset Builder? Asset Processor? Are there more technical (but relatively high-level) details I can add to this?] -->


## Physically based Rendering in Atom

**Physically based rendering (PBR)** is a rendering technique that simulates realistic interaction between materials and light. Atom supports PBR and features PBR material types such as StandardPBR, EnhancedPBR, and other variations. These follow industry standard workflows using metallic and roughness properties. Atom's material system is also capable of rendering non-photo-realistic techniques and special effects through alternate material types. We provide built-in material types focused on PBR rendering, but users can author their own material types to suit their needs.

A full list of material types in Atom is listed in [Material Types in Atom](#material-types-in-atom).

For more information on PBR, see [Physically-based Rendering (PBR)](./pbr.md) and [Working with StandardPBR materials](./create-standardpbr-material.md). 


## Materials
A **material** is a data item that references a material type and defines the material's property values. The material must reference a material type, which defines how the material works and what properties are available. Alternatively, a material may reference another material and inherit its property values. The material inheritance tree can go as deep as needed. 

Material files (`*.material`) are in JSON format. They can be edited using the Material Editor or authored directly. The file is in a simple JSON format and can be authored or machine-generated by scripting outside the Material Editor.

For more information, see [Material File Specification](material-file-spec.md).  

## Material Types
A **material type** is a data item that includes everything that's needed to describe how to render a mesh:  
- A set of `material` property definitions
- Links to shaders
- Scripts that describe how to consume the material properties
- Metadata for the Atom Asset Builder to use when creating Material Type Assets 

<!-- [NOTE FOR DEVS: Is the last bullet point true? Want to explain what the metadata is used for] -->

Material type files (`*.materialtype`) are in JSON format and can be authored directly. This will link together several other files as well, to form a complete material type definition. These additional files include *.shader*, *.azsl*, and *.lua* files.
<!-- [NOTE FOR DEVS] 
- Can we elaborate on why/when they would need to create material types using C++ or Lua? 
- What is the API (or files) for programming material types?
- What is the main purpose of a functor? -->

For more information, see [Material Type File Specification](material-type-file-spec.md).  

### Material Types in Atom
Built into Atom are common material types that you can create materials from. To suit individual needs, you can also create and configure new material types by editing properties, shaders, and functors.

The following material types are included in Atom: 
<!-- [NOTE FOR DEVS: Can you review/edit these descriptions for the material types?] -->
- **StandardPBR**  
    A full-featured PBR material type, but adopts certain feature limitations in order to improve performance. It is meant to provide as much functionality as possible with a limited number of render targets. 
    <!-- For more information on StandardPBR material type, see _[TODO]__.    -->  
    
    This file is located in *dev/Gems/Atom/Feature/Common/Assets/Materials/Types/StandardPBR.materialtype*.

- **EnhancedPBR**  
    An enhanced version of StandardPBR includes additional features, but comes at a higher performance cost. It supports more advanced features that require additional render target (g-buffers). 

    This file is located in *../dev/Gems/Atom/Feature/Common/Assets/Materials/Types/EnhancedPBR.materialtype*. 

- **MinimalPBR**  
    A simple PBR material type with three common properties: base color, metallic factor, and roughness factor. This material type is considered the "hello world" of PBR materials and is provided as an example. It is good place to start for creating custom material types. 

    This file is located in *../dev/Gems/Atom/TestData/TestData/Materials/Types/MinimalPBR.materialtype*. 

- **AutoBrick**  
    A procedural brick material type that includes settings for color, ambient occlusion, brick (width, height, offset), and grout line (width, depth). This material type is an example of a completely custom material type, expanding from the MinimalPBR material type.  

    This file is located in *../dev/Gems/Atom/TestData/TestData/Materials/Types/AutoBrick.materialtype*. 
    

## Material File Example
In the following example, the material inherits from the **StandardPBR** material type and contains the properties `baseColor`, `metallic`, `roughness`, and `normal`. 
```json
{
    "materialType": "StandardPBR.materialtype",
    "properties": {
        "baseColor": {
            "textureMap": "Objects\\textures\\boar\\Copper\\Boar_Copper_BaseColor.png"
        },
        "metallic": {
            "textureMap": "Objects\\textures\\boar\\Copper\\Boar_Copper_Metallic.png"
        },
        "roughness": {
            "textureMap": "Objects\\textures\\boar\\Copper\\Boar_Copper_Roughness.png"
        },
        "normal": {
            "factor": 0.8,
            "textureMap": "Objects\\textures\\boar\\Copper\\Boar_Copper_Normal.png"
        }
    }
}
```

## Material and Material Type Assets
Material and material type files produce **Material Assets** and **Material Type Assets**, respectively. Just like other assets, Material and Material Type Assets are immutable system memory configuration data that contain material and material type data. 

A material type file (`*.materialtype`) produces a Material Type Asset (`*.azmaterialtype`) in the cache. It contains property layout information, a list of shaders to use, and possibly functors for special processing.

A material file (`*.material`) produces a Material Asset (`*.azmaterial`) in the cache. Every Material Asset references a single Material Type Asset. It contains the inherited tree of material property values and compresses it into a single list. Material Assets can be referenced by Model Assets and/or assigned to a model using a Material Component in O3DE. Material Assets can create any number of material instances at runtime for the renderer to use. You can change the property values of a material instance without impacting other instances of the same material.  Unlike a Material Asset, a material instance only exists in memory and not on disk. 
